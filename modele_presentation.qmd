---
title: "Presentation du Modele"
author: "Benzico Pierre & Alexandro Disla"
format: 
    pptx: 
        incremental: true
---

```{r source, eval = T, echo=F,warning = T, message = F}
rm(list = ls())
require(TSstudio)
require(tseries)
require(readxl)
require(writexl)
require(vars)
require(stargazer)
require(knitr)
require(kableExtra)
require(dplyr)
#require(magick)
require(gt)
```


# Presentation des Donnees

## Source des Donnees

- tx.change : Taux de Change Reel
- imp: Importation Haitienne
- exp: Exportation Haitienne
- pib: Produit Interieur Brute Haitienne
- pib.usa: Produit Interieur Brute des Etats Unis
- ipc: L'indice des prix a la Consommation

## Tableau des metadonnees

```{r metadata}
METADATA= read_excel("./data_sources.xlsx",sheet="metadata") %>% as.data.frame()
colnames(METADATA) = c("Variable","Specificite","Periode","Notes")
metadata <- METADATA %>%
gt() %>%
#tab_header(title = md("**Tableau** des metadonnées")) %>% 
tab_options(
    table.width = pct(100)
) %>%
cols_align(
    columns=c("Specificite", "Periode","Notes"),
    align="right"
)%>%
cols_align(
    columns=Variable,
    align="left"
)

metadata
```


## Tableau Presentant les Donnees Brutes

```{r get_data, eval = T, echo=F,warning = T, message = F}
base.data = read_excel("./data_sources.xlsx",sheet = "data")
DATA = subset(base.data,select=-annee) 
DATA = DATA%>% as.data.frame()
LDATA = DATA 
LDATA = LDATA %>%
  lapply(log)%>%
  as.data.frame()
```


```{r gt-table datapres}
row.names(DATA)=c(
      "1988",
      "1989",
      "1990",
      "1991",
      "1992",
      "1993",
      "1994",
      "1995",
      "1996",
      "1997",
      "1998",
      "1999",
      "2000",
      "2001",
      "2002",
      "2003",
      "2004",
      "2005",
      "2006",
      "2007",
      "2008",
      "2009",
      "2010",
      "2011",
      "2012",
      "2013",
      "2014",
      "2015",
      "2016",
      "2017",
      "2018",
      "2019",
      "2020",
      "2021",
      "2022"
    )
table.donnee = DATA%>%
  gt(
    rowname_col =c(
      "1988",
      "1989",
      "1990",
      "1991",
      "1992",
      "1993",
      "1994",
      "1995",
      "1996",
      "1997",
      "1998",
      "1999",
      "2000",
      "2001",
      "2002",
      "2003",
      "2004",
      "2005",
      "2006",
      "2007",
      "2008",
      "2009",
      "2010",
      "2011",
      "2012",
      "2013",
      "2014",
      "2015",
      "2016",
      "2017",
      "2018",
      "2019",
      "2020",
      "2021",
      "2022"
    ),
    rownames_to_stub=TRUE
  )%>%
  #tab_header(title = md("**Table 1** Tableau des données brutes"))%>%
  tab_stubhead(
    label = md("**Year**")
  ) %>%
  tab_source_note(
    source_note = md("**Source:** Banque de la republique d'Haiti")
  ) %>%
  tab_options(
    table.width = pct(200),
    table.font.size=pct(60),
    source_notes.font.size = pct(50)
  ) 


table.donnee
```


## Tableau Presentant les Donnees en Logarithme Neperien


```{r gt-table logdatapres}
row.names(LDATA) =c(
      "1988",
      "1989",
      "1990",
      "1991",
      "1992",
      "1993",
      "1994",
      "1995",
      "1996",
      "1997",
      "1998",
      "1999",
      "2000",
      "2001",
      "2002",
      "2003",
      "2004",
      "2005",
      "2006",
      "2007",
      "2008",
      "2009",
      "2010",
      "2011",
      "2012",
      "2013",
      "2014",
      "2015",
      "2016",
      "2017",
      "2018",
      "2019",
      "2020",
      "2021",
      "2022"
    )
L.table.donnee=LDATA%>%
  gt(
    rowname_col  =c(
      "1988",
      "1989",
      "1990",
      "1991",
      "1992",
      "1993",
      "1994",
      "1995",
      "1996",
      "1997",
      "1998",
      "1999",
      "2000",
      "2001",
      "2002",
      "2003",
      "2004",
      "2005",
      "2006",
      "2007",
      "2008",
      "2009",
      "2010",
      "2011",
      "2012",
      "2013",
      "2014",
      "2015",
      "2016",
      "2017",
      "2018",
      "2019",
      "2020",
      "2021",
      "2022"
    ),
    rownames_to_stub=TRUE
  )%>%
  #tab_header(title = md("**Table 2** Tableau des donnees en Logarithm Neperien"))%>%
  tab_stubhead(
    label = md("**Year**")
  ) %>%
  tab_source_note(
    source_note = md("**Source:** Banque de la republique d'Haiti")
  )%>%
  tab_options(
    table.width = pct(200),
    table.font.size=pct(60),
    source_notes.font.size = pct(50)
  ) 
L.table.donnee
```

# Analyse Graphiques

```{r setup time series format, eval = T, echo=F,warning = T, message = F}
LDATA_TS = ts(LDATA,start=c(1988),end=c(2022),frequency = 1)
DATA_TS = ts(DATA,start=c(1988),end=c(2022),frequency = 1)
```

## Graphes des donnees Brutes

```{r brut plot}
ts_plot(DATA_TS, title = "Evolution des series allant de 1988 a 2022",
  Xgrid=T,
  Ygrid=T,
  line.mode = "lines+markers",
  type = "multiple",
  width = 3
)%>%
plotly::layout(
  yaxis=list(
    showticklabels=F
  )
)
```

## Graphes des donnees en Logarithme Neperien

```{r plot log}
ts_plot(LDATA_TS, title = "Evolution des series (en LN) allant de 1988 a 2022",
  Xgrid=T,
  Ygrid=T,
  type = "multiple"
)
```

